<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG | AI Document Intelligence</title>
    <meta name="description" content="Advanced AI-powered document analysis and chat system built by 10X Technologies.">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v={{ range(1, 10000) | random }}">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Outfit:wght@400;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h1>10X<span>AI</span></h1>
                </div>
                <button class="icon-btn" id="closeSidebar" title="Hide Sidebar">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>

            <div class="sidebar-content">
                <div class="section-label">Knowledge Base</div>
                <div class="file-manager">
                    <div class="upload-zone" id="uploadZone">
                        <input type="file" id="fileUpload" hidden multiple accept=".pdf,.txt,.xlsx,.xls,.csv,.json">
                        <label for="fileUpload" class="upload-button">
                            <i class="fas fa-plus"></i>
                            <span>Add Documents</span>
                        </label>
                    </div>

                    <div class="file-list-container">
                        <div class="file-list-header">
                            <i class="fas fa-database"></i>
                            <span>Existing Files</span>
                            <button id="refreshFiles" class="icon-btn" title="Refresh list">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                        <div id="fileList" class="file-list">
                            <!-- Files injected here -->
                        </div>
                    </div>
                </div>

                <div class="section-label">Tools & Analysis</div>
                <div class="tools-grid">
                    <button class="tool-btn" id="genQuiz">
                        <i class="fas fa-question-circle"></i>
                        <span>Quiz</span>
                    </button>
                    <button class="tool-btn" id="genFlashcards">
                        <i class="fas fa-clone"></i>
                        <span>Flashcards</span>
                    </button>
                    <button class="tool-btn" id="deepAnalysis">
                        <i class="fas fa-microscope"></i>
                        <span>Analysis</span>
                    </button>
                </div>

                <div class="section-header-row">
                    <div class="section-label">Chat History</div>
                    <button class="icon-btn-small" id="newChatBtn" title="New Chat">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                <div id="sessionHistory" class="session-list">
                    <!-- Sessions injected here -->
                    <div class="loading-sessions">
                        <div class="shimmer"></div>
                    </div>
                </div>
            </div>

            <div class="sidebar-footer">
                <div class="system-status">
                    <div class="status-indicator online"></div>
                    <span>AI Engine Ready</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-container">
            <!-- Modal for special features -->
            <div id="resultModal" class="modal-overlay hidden">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="modalTitle">Analysis</h2>
                        <button class="close-modal" id="closeModal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body" id="modalBody">
                        <!-- Content injected here -->
                    </div>
                </div>
            </div>
            <header class="top-bar">
                <button class="icon-btn" id="toggleSidebar" title="Show Sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="current-session">
                    <div class="session-info">
                        <i class="fas fa-message"></i>
                        <span id="session-title">New Intelligence Session</span>
                    </div>
                </div>
                <div class="top-bar-actions">
                    <div id="uploadStatus" class="upload-status-pill hidden">
                        <i class="fas fa-circle-notch fa-spin"></i>
                        <span>Processing...</span>
                    </div>
                    <button class="icon-btn" id="toggleTheme" title="Toggle Theme">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </header>

            <div class="chat-viewport" id="chatContainer">
                <div class="welcome-hero">
                    <div class="hero-content">
                        <div class="hero-icon">
                            <i class="fas fa-wand-magic-sparkles"></i>
                        </div>
                        <h2>What can I help you extract today?</h2>
                        <p>Upload your research papers, financial statements, or datasets to unlock deep insights with
                            AI-powered retrieval.</p>

                        <div class="feature-grid">
                            <div class="feature-card">
                                <i class="fas fa-chart-pie"></i>
                                <span>Dynamic Charts</span>
                            </div>
                            <div class="feature-card">
                                <i class="fas fa-table"></i>
                                <span>Table Analysis</span>
                            </div>
                            <div class="feature-card">
                                <i class="fas fa-quote-left"></i>
                                <span>Smart Citations</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="input-container">
                <div class="input-wrapper">
                    <div class="input-actions-left">
                        <button class="action-btn" id="attachBtn">
                            <i class="fas fa-paperclip"></i>
                        </button>
                    </div>
                    <textarea id="userInput" placeholder="Ask anything about your documents..." rows="1"></textarea>
                    <div class="input-actions-right">
                        <button id="sendBtn" class="send-button">
                            <i class="fas fa-arrow-up"></i>
                        </button>
                    </div>
                </div>
                <div class="input-footer">
                    <p>AI can make mistakes. Check important info.</p>
                </div>
            </footer>
        </main>

        <!-- Right Side Panel (Intelligence Panel) -->
        <aside class="intel-panel hidden" id="intelPanel">
            <div class="intel-header">
                <h2 id="intelTitle">Analysis</h2>
                <button class="icon-btn" id="closeIntel">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="intel-body" id="intelBody">
                <!-- Content injected here -->
            </div>
            <div class="intel-footer" id="intelFooter">
                <!-- Action buttons (New Quiz, Retake) injected here -->
            </div>
        </aside>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}?v={{ range(1, 10000) | random }}"></script>
    <!-- Selection Warning Modal -->
    <div id="selectionModal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 400px; text-align: center; padding: 40px; border-radius: 20px;">
            <i class="fas fa-file-circle-exclamation"
                style="font-size: 4rem; color: var(--primary); margin-bottom: 20px;"></i>
            <h2 style="margin-bottom: 15px; font-weight: 800;">Context Required</h2>
            <p style="color: var(--text-dim); margin-bottom: 30px; line-height: 1.6;">Please select an existing document
                from the sidebar or upload a new one to enable AI analysis and chat.</p>
            <button class="btn-primary" style="width: 100%; border-radius: 12px; height: 50px;"
                onclick="document.getElementById('selectionModal').classList.add('hidden')">Got it</button>
        </div>
    </div>
</body>

</html>